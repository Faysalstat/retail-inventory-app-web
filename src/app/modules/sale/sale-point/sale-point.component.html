<mat-card>
    <h1>Create Sale Invoice:</h1>
    <div class="row">
        <h2 style="font-weight:bold;">
            <mat-icon>face</mat-icon> CUSTOMER
        </h2>
        <app-page-loader *ngIf="showLoader"></app-page-loader>
        <div class="col-md-4">
            <mat-form-field class="input-field" appearance="outline">
                <mat-label>Mobile No:</mat-label>
                <input (change)="searchSupllyer()" pInputText [ngModelOptions]="{standalone:true}" [disabled]="isEdit"
                    [(ngModel)]="person.contactNo" placeholder="Contact No" matInput>
            </mat-form-field>
        </div>
        <div class="col-md-4">
            <mat-form-field class="input-field" appearance="outline">
                <mat-label>Supplyer Name:</mat-label>
                <input [ngModelOptions]="{standalone:true}" [(ngModel)]="person.personName"
                    [disabled]="isCustomerExist" placeholder="Supplyer Name" matInput>
            </mat-form-field>
        </div>
        <div class="col-md-4">
            <mat-form-field class="input-field" appearance="outline">
                <mat-label>Shop Name:</mat-label>
                <input [ngModelOptions]="{standalone:true}" [(ngModel)]="customer.shopName" [disabled]="isCustomerExist"
                    placeholder="Shop Name" matInput>
            </mat-form-field>
        </div>
        
        <div class="col-md-12">
            <mat-form-field class="input-field" appearance="outline">
                <mat-label>Address:</mat-label>
                <textarea pInputText [ngModelOptions]="{standalone:true}" [disabled]="isCustomerExist"
                    [(ngModel)]="person.personAddress" matInput></textarea>
            </mat-form-field>
        </div>
        <div class="col-md-12">
            <button *ngIf="!isCustomerExist" (click)="addCustomer()" mat-raised-button color="warn">Add
                Supplyer</button>
        </div>
        <p style="color:red;font-weight:bolder">{{errMsg}}</p>
    </div>
    <hr>
    <form [formGroup]="saleInvoiceIssueForm" (keydown.enter)="$event.preventDefault()">
        <div class="row">
            <h2 style="font-weight:bold;">
                <mat-icon>shopping_cart</mat-icon> ORDER
            </h2>
            <div class="col-md-12">
                    <mat-form-field class="input-field" appearance="outline">
                        <mat-label>Select Product</mat-label>
                        <input type="text" matInput [formControl]="productName" [(ngModel)]="selectedProduct" [matAutocomplete]="auto">
                        <mat-autocomplete (optionSelected)="productSelected($event)" #auto="matAutocomplete" [displayWith]="displayFn">
                            <mat-option *ngFor="let product of filteredOptions | async" [value]="product">
                                {{product.productName}}
                            </mat-option>
                        </mat-autocomplete>
                    </mat-form-field>
            </div>
            <div class="col-md-4">
                <mat-form-field class="input-field" appearance="outline">
                    <mat-label>Selling Price</mat-label>
                    <input pInputText [ngModelOptions]="{standalone:true}" (change)="calculateOrder()"
                        [(ngModel)]="orderItem.pricePerUnit" placeholder="Selling Price" matInput>
                </mat-form-field>
            </div>
            <div class="col-md-2">
                <mat-form-field class="input-field" appearance="outline">
                    <mat-label>Packaging</mat-label>
                    <input type="text" pInputText [ngModelOptions]="{standalone:true}" [disabled]="true"
                        [(ngModel)]="orderItem.packagingCategory" placeholder="Packaging"
                        matInput>
                </mat-form-field>
            </div>
            <div class="col-md-2">
                <mat-form-field class="input-field" appearance="outline">
                    <mat-label>Quantity per Package</mat-label>
                    <input type="number" pInputText [ngModelOptions]="{standalone:true}" [disabled]="true"
                    [(ngModel)]="orderItem.unitPerPackage" placeholder="Quantity per Package"
                        matInput>
                </mat-form-field>
            </div>
            <div class="col-md-4">
                <mat-form-field class="input-field" appearance="outline">
                    <mat-label>Number Of Package</mat-label>
                    <input type="number" pInputText [ngModelOptions]="{standalone:true}"
                        (change)="calculateQuantity()" [(ngModel)]="orderItem.quantityOrdered" placeholder="Quantity per Package"
                        matInput>
                </mat-form-field>
            </div>
            
            <div class="col-md-4">
                <mat-form-field class="input-field" appearance="outline">
                    <mat-label>Quantity</mat-label>
                    <input type="number" pInputText [ngModelOptions]="{standalone:true}" [disabled]="isEdit"
                        (change)="calculateOrder()" [(ngModel)]="orderItem.quantityOrdered" placeholder="Quantity"
                        matInput>
                </mat-form-field>
            </div>
            <!-- <div class="col-md-1">
                <h3 style="font-weight:bold;margin-top:8px;">{{unitType}}</h3>
            </div> -->
            <div class="col-md-4">
                <mat-form-field class="input-field" appearance="outline">
                    <mat-label>Total Price</mat-label>
                    <input type="number" pInputText [ngModelOptions]="{standalone:true}" [disabled]="isEdit"
                        [(ngModel)]="orderItem.totalOrderPrice" placeholder="Selling Price" matInput>
                </mat-form-field>
            </div>
            <div class="col-md-12">
                <button (click)="addOrder()" mat-raised-button color="warn">Add
                    Order</button>
            </div>
        </div>
        <div class="row">
            <hr class="mt-3">
            <div class="col-md-12 mt-3">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>SN</th>
                            <th>Product Name</th>
                            <th>Rate</th>
                            <th>Quantity</th>
                            <th>Price</th>
                            <!-- <th>Action</th> -->
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let order of orderList; index as i">
                            <th scope="row">{{i+1}}</th>
                            <th>{{order.productName}}</th>
                            <th>{{order.pricePerUnit}}</th>
                            <th>{{order.quantityOrdered}} {{order.unitType}}</th>
                            <th>{{order.totalOrderPrice}}</th>
                            <!-- <th>{{order.totalPrice}}</th> -->
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div class="row">
            <hr class="mt-3">
            <h2 style="font-weight:bold;">
                <mat-icon>receipt</mat-icon> SUMMARY
            </h2>
            <div class="col-md-3">
                <mat-form-field class="input-field" appearance="outline">
                    <mat-label>Total Price:</mat-label>
                    <input formControlName="totalPrice" (keyup)="calculateSummary()"
                        [disabled]="isEdit" placeholder="Total Price" matInput>
                </mat-form-field>
            </div>

            <div class="col-md-3">
                <mat-form-field class="input-field" appearance="outline">
                    <mat-label>Paid:</mat-label>
                    <input formControlName="amountPaid" (keyup)="calculateSummary()"
                        [disabled]="isEdit" placeholder="Paid Amount" matInput>
                </mat-form-field>
            </div>
            <!--   -->
            <div class="col-md-3">
                <mat-form-field class="input-field" appearance="outline">
                    <mat-label>Due:</mat-label>
                    <input formControlName="duePayment"
                        [disabled]="isEdit" placeholder="Due Amount" matInput>
                </mat-form-field>
            </div>
            <div class="col-md-3">
                <mat-form-field class="input-field" appearance="outline">
                    <mat-label>Rebate:</mat-label>
                    <input formControlName="rebate" (keyup)="calculateSummary()"
                        [disabled]="isEdit" placeholder="Rebate" matInput>
                </mat-form-field>
            </div>
            <div *ngIf="isEdit" class="col-md-3">
                <mat-form-field class="input-field" appearance="outline">
                    <mat-label>New Payment:</mat-label>
                    <input formControlName="newPayment" (keyup)="calculateSummary()"
                        [disabled]="isEdit" placeholder="New Payment" matInput>
                </mat-form-field>
            </div>
            <div class="col-md-12">
                <mat-form-field class="input-field" appearance="outline">
                    <mat-label>Comment:</mat-label>
                    <textarea type="text" pInputText formControlName="comment" matInput>
                        Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
                    </textarea>
                </mat-form-field>
            </div>
            <div class="col-md-12">
                <button (click)="submitOrder()" mat-raised-button color="warn">Submit</button>
            </div>
        </div>
    </form>
</mat-card>