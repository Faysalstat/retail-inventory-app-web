<mat-card>
    <h1>Create Sale Invoice:</h1>
    <div class="row">
        <h2 style="font-weight:bold;">
            <mat-icon>face</mat-icon> CUSTOMER
        </h2>
        <app-page-loader *ngIf="showLoader"></app-page-loader>
        <div class="col-md-4">
            <mat-form-field class="input-field" appearance="outline">
                <mat-label>Mobile No:</mat-label>
                <input (change)="searchCustomer()" pInputText [ngModelOptions]="{standalone:true}" [disabled]="isEdit"
                    [(ngModel)]="person.contactNo" placeholder="Contact No" matInput>
            </mat-form-field>
        </div>
        <div class="col-md-4">
            <mat-form-field class="input-field" appearance="outline">
                <mat-label>Supplyer Name:</mat-label>
                <input [ngModelOptions]="{standalone:true}" [(ngModel)]="person.personName" [disabled]="isCustomerExist"
                    placeholder="Supplyer Name" matInput>
            </mat-form-field>
        </div>
        <div class="col-md-4">
            <mat-form-field class="input-field" appearance="outline">
                <mat-label>Shop Name:</mat-label>
                <input [ngModelOptions]="{standalone:true}" [(ngModel)]="customer.shopName" [disabled]="isCustomerExist"
                    placeholder="Shop Name" matInput>
            </mat-form-field>
        </div>

        <div class="col-md-12">
            <mat-form-field class="input-field" appearance="outline">
                <mat-label>Address:</mat-label>
                <textarea pInputText [ngModelOptions]="{standalone:true}" [disabled]="isCustomerExist"
                    [(ngModel)]="person.personAddress" matInput></textarea>
            </mat-form-field>
        </div>
        <div class="col-md-12">
            <h2 style="font-weight:bold ;">Balance: {{account.balance}}</h2>
        </div>
        <!-- <div class="col-md-12 mt-2">
            <button *ngIf="!isCustomerExist" (click)="addCustomer()" mat-raised-button color="warn">Add
                Supplyer</button>
        </div> -->
        <p style="color:red;font-weight:bolder">{{errMsg}}</p>
    </div>
    <hr>
    <form [formGroup]="saleInvoiceIssueForm" (keydown.enter)="$event.preventDefault()">
        <div class="row">
            <h2 style="font-weight:bold;">
                <mat-icon>shopping_cart</mat-icon> ORDER
            </h2>
            <div class="col-md-12">
                <form>
                    <mat-form-field class="input-field" appearance="outline">
                        <mat-label>Select Product</mat-label>
                        <input type="text" matInput [formControl]="productName" [matAutocomplete]="auto">
                        <mat-autocomplete (optionSelected)="productSelected($event)" #auto="matAutocomplete"
                            [displayWith]="displayFn">
                            <mat-option *ngFor="let product of filteredOptions | async" [value]="product">
                                {{product.productName}}
                            </mat-option>
                        </mat-autocomplete>
                    </mat-form-field>
                </form>
            </div>
            <div class="col-md-2">
                <mat-form-field class="input-field" appearance="outline">
                    <mat-label>Buying Price Rate</mat-label>
                    <input pInputText [ngModelOptions]="{standalone:true}" (change)="calculateOrder()"
                        [(ngModel)]="orderItem.pricePerUnit" placeholder="Selling Price" matInput>
                </mat-form-field>
            </div>
            <div class="col-md-2">
                <mat-form-field class="input-field" appearance="outline">
                    <mat-label>Unit Per Package</mat-label>
                    <input type="number" pInputText [ngModelOptions]="{standalone:true}" [disabled]="true"
                        [(ngModel)]="orderItem.unitPerPackage" placeholder="Quantity/Pakage" matInput>
                </mat-form-field>
            </div>
            <div class="col-md-2">
                <mat-form-field class="input-field" appearance="outline">
                    <mat-label>Package Quantity</mat-label>
                    <input type="number" pInputText [ngModelOptions]="{standalone:true}" [disabled]="isEdit"
                        (change)="calculateQuantity()" [(ngModel)]="orderItem.packageQuantity" placeholder="Quantity"
                        matInput>
                </mat-form-field>
            </div>
            <div class="col-md-2">
                <mat-form-field class="input-field" appearance="outline">
                    <mat-label>Loose Quantity</mat-label>
                    <input type="number" pInputText [ngModelOptions]="{standalone:true}" [disabled]="isEdit"
                        (change)="calculateQuantity()" [(ngModel)]="orderItem.looseQuantity" placeholder="Quantity"
                        matInput>
                </mat-form-field>
            </div>
            <div class="col-md-2">
                <mat-form-field class="input-field" appearance="outline">
                    <mat-label>Total Quantity</mat-label>
                    <input type="number" pInputText [ngModelOptions]="{standalone:true}" [disabled]="isEdit"
                        (change)="calculateOrder()" [(ngModel)]="orderItem.quantityOrdered" placeholder="Quantity"
                        matInput>
                </mat-form-field>
            </div>
            <!-- <div class="col-md-1">
                        <h3 style="font-weight:bold;margin-top:8px;">{{unitType}}</h3>
                    </div> -->
            <div class="col-md-2">
                <mat-form-field class="input-field" appearance="outline">
                    <mat-label>Total Price (BDT)</mat-label>
                    <input type="number" pInputText [ngModelOptions]="{standalone:true}" [disabled]="isEdit"
                        [(ngModel)]="orderItem.totalOrderPrice" placeholder="Selling Price" matInput>
                </mat-form-field>
            </div>
            <div class="col-md-12">
                <button (click)="addOrder()" mat-raised-button color="warn">Add
                    Order</button>
            </div>
        </div>
        <div class="row">
            <hr class="mt-3">
            <div class="col-md-12 mt-3">
                <table class="table table-striped" style="text-align:center ;">
                    <thead>
                        <tr>
                            <th>SN</th>
                            <th style="width:50% ;">Product Name</th>
                            <th>Rate</th>
                            <th>Quantity</th>
                            <th>Price</th>
                            <!-- <th>Action</th> -->
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngIf="orderList.length==0">
                            <th colspan="5" style="font-weight:bold;text-align: center;">No Order Added Yet!</th>
                        </tr>
                        <tr *ngFor="let order of orderList; index as i">
                            <th scope="row">{{i+1}}</th>
                            <th>{{order.productName}}</th>
                            <th>{{order.pricePerUnit}}</th>
                            <th>{{order.quantityOrdered}} {{order.unitType}}</th>
                            <th>{{order.totalOrderPrice}}</th>
                            <!-- <th>{{order.totalPrice}}</th> -->
                        </tr>
                    </tbody>
                    <tfoot style="font-weight:bolder;">
                        <tr>
                            <th colspan="3" rowspan="5"></th>
                            <th style="text-align:left;">Total:</th>
                            <th>{{this.totalPrice}} BDT</th>
                        </tr>
                        <tr>
                            <th style="text-align:left;">Previous {{balanceTitle}}:</th>
                            <th>{{this.previousBalance}} BDT</th>
                        </tr>
                        <tr>
                            <th style="text-align:left;">Total:</th>
                            <th>{{this.totalPayableAmount}} BDT</th>
                        </tr>
                        <tr>
                            <th style="text-align:left;">Paid:</th>
                            <th>
                                <mat-form-field class="input-field" appearance="fill">
                                    <input type="number" pInputText formControlName="totalPaidAmount"
                                        placeholder="Amount" matInput>
                                </mat-form-field>
                            </th>
                        </tr>
                        <!-- <tr>
                            <th colspan="2">
                                <mat-form-field class="input-field" appearance="outline">
                                    <mat-label>Comment:</mat-label>
                                    <textarea type="text" pInputText [ngModelOptions]="{standalone:true}" [(ngModel)]="comment" matInput>
                                        
                                    </textarea>
                                </mat-form-field>
                            </th>
                        </tr> -->
                        <tr>
                            <!-- <th style="text-align:left;">Comment:</th> -->
                            <th colspan="3">
                                <mat-form-field class="input-field" appearance="outline">
                                    <mat-label>Comment:</mat-label>
                                    <textarea type="text" pInputText [ngModelOptions]="{standalone:true}"
                                        [(ngModel)]="comment" matInput>

                                    </textarea>
                                </mat-form-field>
                                <div class="row">
                                    <div class="col-md-12" style="float:right ;">
                                        <button style="margin-right:20px ;" (click)="submitOrder()" mat-raised-button
                                            color="warn">Submit</button>
                                        <!-- <button (click)="downloadInvoice()" mat-raised-button
                                            color="accent">Download</button> -->
                                    </div>
                                </div>
                            </th>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>
    </form>
</mat-card>